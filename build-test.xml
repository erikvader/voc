<project name="python" default="run" basedir="." xmlns:jacoco="antlib:org.jacoco.ant">
  <target name="build">
    <mkdir dir="${build}/jtests" />
    <javac debug="true"
           includeantruntime="false"
           destdir="${build}/jtests">
      <src path="jtests" />
      <classpath path="${build}/java" />
      <classpath path="lib/junit.jar" />
    </javac>
  </target>

  <taskdef uri="antlib:org.jacoco.ant" resource="org/jacoco/ant/antlib.xml">
    <classpath path="lib/jacocoant.jar"/>
  </taskdef>

  <target name="test" depends="build">
    <jacoco:coverage>
      <junit printsummary="yes" fork="yes" forkmode="once">
        <classpath>
          <pathelement location="lib/junit.jar" />
          <pathelement location="lib/hamcrest-core.jar" />
          <pathelement location="${build}/jtests" />
          <pathelement location="${build}/java" />
        </classpath>

        <formatter type="plain" />

        <test name="DateTimeTest" />
      </junit>
    </jacoco:coverage>

    <jacoco:report>
      <executiondata>
        <file file="jacoco.exec" />
      </executiondata>

      <structure name="voc">
        <classfiles>
          <fileset dir="${build}/java" />
          <fileset dir="${build}/jtests" />
        </classfiles>

        <sourcefiles>
          <fileset dir="${src}/common" />
        </sourcefiles>
      </structure>

      <html destdir="coverage_report" />
    </jacoco:report>
  </target>

  <target name="clean">
    <delete>
      <fileset dir="." includes="TEST-*.txt" />
    </delete>
  </target>
</project>
